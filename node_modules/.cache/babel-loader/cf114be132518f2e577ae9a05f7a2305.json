{"ast":null,"code":"import { mapGetters } from 'vuex';\nimport _throttle from 'lodash';\nexport default {\n  name: 'ShopCart',\n\n  mounted() {\n    this.getData();\n  },\n\n  methods: {\n    getData() {\n      this.$store.dispatch('getCartList');\n    },\n\n    changeSkuNum: _.throttle(function (type, value, cart) {\n      switch (type) {\n        case 'add':\n          value = 1;\n          break;\n\n        case 'min':\n          cart.skuNum > 1 ? value = -1 : value = 0;\n          break;\n\n        case 'change':\n          isNaN(value) || value < 0 ? value = 0 : value = parseInt(value) - cart.skuNum;\n          break;\n      }\n\n      this.$store.dispatch('addOrUpdateShopCar', {\n        skuid: cart.skuId,\n        skuNum: value\n      }).then(() => {\n        if (cart.skuNum === 1 && value === 0 && confirm('是否删除商品？')) {\n          this.deletCartById(cart);\n          this.getData();\n        } else this.getData();\n      }).catch(error => {\n        console.log(error);\n      });\n    }, 1300),\n\n    deletCartById(cart) {\n      this.$store.dispatch('deleteCartListBySkuId', cart.skuId).then(() => {\n        this.getData();\n      }).catch(error => {\n        alert(error);\n      });\n    },\n\n    updateChecked(cart, event) {\n      this.$store.dispatch('updateCheckBySkuId', {\n        skuId: cart.skuId,\n        isChecked: event.target.checked === true ? '1' : '0'\n      }).then(() => {\n        this.getData();\n      }).catch(error => {\n        alert(error);\n      });\n    },\n\n    deletAllCheckedCart() {\n      this.$store.dispatch('deletAllCheckedCart').then(() => {\n        this.getData();\n      }).catch(error => {\n        alert(error);\n      });\n    },\n\n    allChecked(event) {\n      this.$store.dispatch('checkedAll', event).then(() => {\n        this.getData();\n      }).catch(error => {\n        alert(error);\n      });\n    }\n\n  },\n  computed: { ...mapGetters(['cartInfo']),\n\n    cartInfoList() {\n      return this.cartInfo.cartInfoList || [];\n    },\n\n    totalPrice() {\n      let sum = 0;\n      this.cartInfoList.forEach(item => {\n        if (item.isChecked == 1) sum = sum + item.skuNum * item.skuPrice;\n      });\n      return sum;\n    },\n\n    isAllChecked() {\n      let flag = 1;\n      this.cartInfoList.forEach(item => {\n        flag = flag * parseInt(item.isChecked);\n      });\n      return flag == 1 ? true : false;\n    }\n\n  }\n};","map":null,"metadata":{},"sourceType":"module"}